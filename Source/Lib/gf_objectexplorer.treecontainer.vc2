*--------------------------------------------------------------------------------------------------------------------------------------------------------
* (ES) AUTOGENERADO - ¡¡ATENCIÓN!! - ¡¡NO PENSADO PARA EJECUTAR!! USAR SOLAMENTE PARA INTEGRAR CAMBIOS Y ALMACENAR CON HERRAMIENTAS SCM!!
* (EN) AUTOGENERATED - ATTENTION!! - NOT INTENDED FOR EXECUTION!! USE ONLY FOR MERGING CHANGES AND STORING WITH SCM TOOLS!!
*--------------------------------------------------------------------------------------------------------------------------------------------------------
*< FOXBIN2PRG: Version="1.19" SourceFile="gf_objectexplorer.vcx" /> (Solo para binarios VFP 9 / Only for VFP 9 binaries)
*
DEFINE CLASS treecontainer AS container 
 	*< CLASSDATA: Baseclass="container" Timestamp="" Scale="Pixels" Uniqueid="" />

	*-- OBJECTDATA items order determines ZOrder / El orden de los items OBJECTDATA determina el ZOrder 
	*< OBJECTDATA: ObjPath="oleTree" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="txtFullPath" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="oPropGrid" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Label1" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="cntCheckBoxes" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="cntCheckBoxes.chklShowNative" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="cntCheckBoxes.chklShowInherited" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="cntCheckBoxes.chklShowCustom" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="cntCheckBoxes.chklShowNonDefault" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="cntCheckBoxes.lblFilter" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="cntCheckBoxes.txtFilter" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="cmdBrowse" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="chklSortFavorites" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="chklHighlightFavorites" UniqueID="" Timestamp="" />

	#INCLUDE "objectexplorerversion.h"
	*<DefinedPropArrayMethod>
		*m: about
		*m: addtoobjectlist
		*m: assignpublicvariable
		*m: browse		&& Called to Browse the table identified in the current node; see also BrowseRefresh.
		*m: browsecursor
		*m: cfavorites_access
		*m: closetable
		*m: createcursorforgrid
		*m: createtagobject
		*m: dblclickcursor
		*m: editvalue
		*m: explore
		*m: fillgridwitharray
		*m: fillgridwithproperties		&& Displays the properties for the passed node.
		*m: fixcaseofproperty
		*m: getbrowsecursorname		&& Returns the name of the cursor for the Browse button and saves the DataSessionID it is found in.
		*m: getcollectionnodename		&& For items in a collection, returns the caption to be used for nodes in the TreeView
		*m: getnodefor
		*m: getnodetext		&& For objects other than collections, returns the caption to be used for nodes in the TreeView
		*m: getobjectreference		&& Returns the object reference to the item represented by a node.
		*m: getsavedproperty
		*m: gridrightclick
		*m: haschildobjects
		*m: inputbox
		*m: loadchildobjects		&& Loads the member objects of an object into the tree view.
		*m: loadcollectionitems		&& Loads the items in a collection into the treeview.
		*m: loadobject		&& Loads an object into the TreeView.
		*m: loadotherobjects		&& Loads the properties of an object into the treeview.
		*m: locktreeview
		*m: logchange		&& Hook to allow capture of changes made to properties
		*m: navigatetoobject
		*m: newnode		&& Adds an empty node to the treeview.
		*m: ocurrentnode_access
		*m: onobjectreleased		&& Fired when the object being explored is released
		*m: pemstatusfails
		*m: refreshgrid
		*m: resizecontrols
		*m: saveproperty
		*m: setfavoritehighlighting
		*m: setupgridcolumns
		*m: skippropertyname
		*m: sortnode
		*m: togglefavorite
		*m: transformcharacter		&& Returns the text for character values that appear in the third column of the grid.
		*m: treeviewrightclick
		*m: usekeywordtable
		*m: zapcursor
		*p: cbrowsefont		&& Sets the font to be used when browsing a cursor.
		*p: ccklkeywordcursor
		*p: ccklkeywordtablename		&& Used when Explorer is used and Thor is not in use (presumably, in Production), returns the name of the table used by Thor's Custom Keyword List.
		*p: ccollectionitemprefix		&& Used in Treeview for item names in a collection
		*p: ccursorname
		*p: cdefaultfavorites
		*p: cfavorites
		*p: cfilter
		*p: cmyfavorites		&& My custom list of properties that are Favorites (separated by spaces, commas, or new lines)
		*p: cskippedobjectnames		&& List of object names that I want Explorer to Ignore
		*p: cversion
		*p: cvfpkeywordcursor
		*p: cvfpkeywordtablename		&& Used when Explorer is used and Thor is not in use (presumably, in Production), FoxPro's native table for keyword names
		*p: laligninputboxtocursor
		*p: lbrowsereadonly
		*p: ldblclickreadonly
		*p: lfavoritesbold
		*p: lhighlightfavorites
		*p: lshowcaption		&& Show Caption in treeview node
		*p: lshowcontrolsource		&& Show ControlSource in treeview node
		*p: lshowcustom		&& Show Custom properties
		*p: lshowinherited		&& Show Inherited properties
		*p: lshowitems		&& Indicates the items in a collection should be displayed in the tree.
		*p: lshowmemberobjects		&& Indicates that member objects should be displayed in the treeview.
		*p: lshownative		&& Show Native properties
		*p: lshownondefault
		*p: lsortfavorites
		*p: lsorttreeviewnodes		&& Sorts TreeView nodes alphabetically
		*p: lwindowlocked
		*p: nbrowsedatasessionid
		*p: nfavoritesbackcolor
		*p: nfontsize
		*p: nmaxcharacterwidth
		*p: nmousebutton
		*p: ocurrentnode
		*p: ofirstobject		&& Stores an object reference to the top most object in the treeview.
		*p: ofixcase
		*a: aobjectlist[1,0]
		*a: apems[1,0]
		*p: _memberdata		&& XML Metadata for customizable properties
	*</DefinedPropArrayMethod>

	*<PropValue>
		Anchor = 15
		BorderWidth = 0
		cbrowsefont = 
		ccklkeywordcursor = 
		ccklkeywordtablename = (Iif(Type('_Screen.Cthorfolder') = 'C', _screen.Cthorfolder + "tools\my tools\keywordlist.dbf", ''))
		ccollectionitemprefix = Item
		ccursorname = 
		cdefaultfavorites = caption, controlsource, recordsource, baseclass, class, classlibrary, parentclass, top, left, width, height, text, value, enabled, visible, rowsource, rowsourcetype, datasessionid
		cfavorites = 
		cfilter = 
		cmyfavorites = 
		cskippedobjectnames = 
		cversion = 3.4 - 2022/12/26
		cvfpkeywordcursor = 
		cvfpkeywordtablename = C:\PROGRAM FILES (X86)\MICROSOFT VISUAL FOXPRO 9\WIZARDS\FDKEYWRD.dbf
		Height = 623
		laligninputboxtocursor = .T.
		lbrowsereadonly = .F.
		ldblclickreadonly = .F.
		lfavoritesbold = .T.
		lhighlightfavorites = .F.
		lshowcaption = .T.
		lshowcontrolsource = .T.
		lshowcustom = .T.
		lshowinherited = .T.
		lshowitems = .T.
		lshowmemberobjects = .T.
		lshownative = .T.
		lshownondefault = .F.
		lsortfavorites = .F.
		lsorttreeviewnodes = .T.
		lwindowlocked = .F.
		Name = "treecontainer"
		nbrowsedatasessionid = 0
		nfavoritesbackcolor = (RGB(255, 255, 128))
		nfontsize = 9
		nmaxcharacterwidth = 200
		nmousebutton = 0
		ocurrentnode = .NULL.
		ofirstobject = .NULL.
		ofixcase = .NULL.
		Width = 623
		_memberdata = <VFPData>
			<memberdata name="addtoobjectlist" display="AddToObjectList"/>
			<memberdata name="dblclickcursor" display="DblClickCursor"/>
			<memberdata name="fillgridwithproperties" display="FillGridWithProperties"/>
			<memberdata name="getnodefor" display="GetNodeFor"/>
			<memberdata name="getnodetext" display="GetNodeText" favorites="True"/>
			<memberdata name="getobjectreference" display="GetObjectReference"/>
			<memberdata name="getsavedproperty" display="GetSavedProperty"/>
			<memberdata name="haschildobjects" display="HasChildObjects"/>
			<memberdata name="loadchildobjects" display="LoadChildObjects"/>
			<memberdata name="loadcollectionitems" display="LoadCollectionItems"/>
			<memberdata name="loadobject" display="LoadObject"/>
			<memberdata name="loadotherobjects" display="LoadOtherObjects"/>
			<memberdata name="navigatetoobject" display="NavigateToObject"/>
			<memberdata name="newnode" display="NewNode"/>
			<memberdata name="resizecontrols" display="ResizeControls"/>
			<memberdata name="saveproperty" display="SaveProperty"/>
			<memberdata name="transformcharacter" display="TransformCharacter" favorites="True"/>
			<memberdata name="aobjectlist" display="aObjectList"/>
			<memberdata name="ccursorname" display="cCursorName"/>
			<memberdata name="cversion" display="cVersion"/>
			<memberdata name="lshowitems" display="lShowItems"/>
			<memberdata name="lshowmemberobjects" display="lShowMemberObjects"/>
			<memberdata name="lsorttreeviewnodes" display="lSortTreeViewNodes" favorites="True"/>
			<memberdata name="nfontsize" display="nFontSize" favorites="True"/>
			<memberdata name="ocurrentnode" display="oCurrentNode"/>
			<memberdata name="ocurrentnode_access" display="oCurrentNode_Access"/>
			<memberdata name="ofirstobject" display="oFirstObject"/>
			<memberdata name="explore" display="Explore"/>
			<memberdata name="lshowcaption" display="lShowCaption" favorites="True"/>
			<memberdata name="lshowcontrolsource" display="lShowControlSource" favorites="True"/>
			<memberdata name="ccollectionitemprefix" display="cCollectionItemPrefix" favorites="True"/>
			<memberdata name="lshowcustom" display="lShowCustom"/>
			<memberdata name="lshowinherited" display="lShowInherited"/>
			<memberdata name="lshownative" display="lShowNative"/>
			<memberdata name="lshownondefault" display="lShowNonDefault"/>
			<memberdata name="getcollectionnodename" display="GetCollectionNodeName" favorites="True"/>
			<memberdata name="sortnode" display="SortNode"/>
			<memberdata name="about" display="About"/>
			<memberdata name="fixcaseofproperty" display="FixCaseofProperty"/>
			<memberdata name="ofixcase" display="oFixCase"/>
			<memberdata name="locktreeview" display="LockTreeView"/>
			<memberdata name="lwindowlocked" display="lWindowLocked"/>
			<memberdata name="fillgridwitharray" display="FillGridWithArray"/>
			<memberdata name="cskippedobjectnames" display="cSkippedObjectNames" favorites="True"/>
			<memberdata name="createcursorforgrid" display="CreateCursorForGrid"/>
			<memberdata name="setupgridcolumns" display="SetupGridColumns"/>
			<memberdata name="zapcursor" display="ZapCursor"/>
			<memberdata name="refreshgrid" display="RefreshGrid"/>
			<memberdata name="pemstatusfails" display="PemstatusFails"/>
			<memberdata name="cvfpkeywordtablename" display="cVFPKeywordTableName" favorites="True"/>
			<memberdata name="ccklkeywordtablename" display="cCKLKeywordTableName" favorites="True"/>
			<memberdata name="cvfpkeywordcursor" display="cVFPKeywordCursor"/>
			<memberdata name="ccklkeywordcursor" display="cCKLKeywordCursor"/>
			<memberdata name="usekeywordtable" display="UseKeywordTable"/>
			<memberdata name="closetable" display="CloseTable"/>
			<memberdata name="lsortfavorites" display="lSortFavorites"/>
			<memberdata name="lfavoritesbold" display="lFavoritesBold" favorites="True"/>
			<memberdata name="nfavoritesbackcolor" display="nFavoritesBackColor" favorites="True"/>
			<memberdata name="nmaxcharacterwidth" display="nMaxCharacterWidth"/>
			<memberdata name="inputbox" display="InputBox"/>
			<memberdata name="browsecursor" display="BrowseCursor"/>
			<memberdata name="browse" display="Browse"/>
			<memberdata name="ldblclickreadonly" display="lDblClickReadOnly" favorites="True"/>
			<memberdata name="lbrowsereadonly" display="lBrowseReadOnly" favorites="True"/>
			<memberdata name="cbrowsefont" display="cBrowseFont" favorites="True"/>
			<memberdata name="cfilter" display="cFilter"/>
			<memberdata name="width" display="Width"/>
			<memberdata name="skippropertyname" display="SkipPropertyName"/>
			<memberdata name="laligninputboxtocursor" display="lAlignInputBoxToCursor" favorites="True"/>
			<memberdata name="cdefaultfavorites" display="cDefaultFavorites"/>
			<memberdata name="cfavorites" display="cFavorites"/>
			<memberdata name="cfavorites_access" display="cFavorites_Access"/>
			<memberdata name="cmyfavorites" display="cMyFavorites" favorites="True"/>
			<memberdata name="getbrowsecursorname" display="GetBrowseCursorName" favorites="True"/>
			<memberdata name="nbrowsedatasessionid" display="nBrowseDataSessionID"/>
			<memberdata name="logchange" display="LogChange" favorites="True"/>
			<memberdata name="onobjectreleased" display="OnObjectReleased"/>
			<memberdata name="lhighlightfavorites" display="lHighlightFavorites"/>
			<memberdata name="setfavoritehighlighting" display="SetFavoriteHighlighting"/>
			<memberdata name="gridrightclick" display="GridRightClick"/>
			<memberdata name="editvalue" display="EditValue"/>
			<memberdata name="togglefavorite" display="ToggleFavorite"/>
			<memberdata name="nmousebutton" display="nMouseButton"/>
			<memberdata name="treeviewrightclick" display="TreeViewRightClick"/>
			<memberdata name="assignpublicvariable" display="AssignPublicVariable"/>
			<memberdata name="createtagobject" display="CreateTagObject"/>
		</VFPData>
	*</PropValue>

	ADD OBJECT 'chklHighlightFavorites' AS checkbox WITH ;
		Alignment = 0, ;
		Anchor = 4, ;
		AutoSize = .T., ;
		Caption = "Highlight Favorites", ;
		ControlSource = "This.Parent.lHighlightFavorites", ;
		FontBold = .T., ;
		Height = 17, ;
		Left = 135, ;
		Name = "chklHighlightFavorites", ;
		Top = 602, ;
		Width = 122
		*< END OBJECT: BaseClass="checkbox" />

	ADD OBJECT 'chklSortFavorites' AS checkbox WITH ;
		Alignment = 0, ;
		Anchor = 4, ;
		AutoSize = .T., ;
		Caption = "Favorites on top", ;
		ControlSource = "This.Parent.lSortFavorites", ;
		FontBold = .T., ;
		Height = 17, ;
		Left = 8, ;
		Name = "chklSortFavorites", ;
		Top = 602, ;
		Width = 108
		*< END OBJECT: BaseClass="checkbox" />

	ADD OBJECT 'cmdBrowse' AS commandbutton WITH ;
		Anchor = 4, ;
		AutoSize = .T., ;
		Caption = "Browse", ;
		Height = 27, ;
		Left = 269, ;
		Name = "cmdBrowse", ;
		Top = 596, ;
		Width = 60
		*< END OBJECT: BaseClass="commandbutton" />

	ADD OBJECT 'cntCheckBoxes' AS container WITH ;
		Anchor = 40, ;
		BorderWidth = 0, ;
		Height = 31, ;
		Left = 212, ;
		Name = "cntCheckBoxes", ;
		Top = 5, ;
		Width = 761
		*< END OBJECT: BaseClass="container" />

	ADD OBJECT 'cntCheckBoxes.chklShowCustom' AS checkbox WITH ;
		Alignment = 0, ;
		AutoSize = .T., ;
		Caption = "Custom", ;
		ControlSource = "This.Parent.Parent.lShowCustom", ;
		FontBold = .T., ;
		Height = 17, ;
		Left = 334, ;
		Name = "chklShowCustom", ;
		Top = 8, ;
		Width = 62
		*< END OBJECT: BaseClass="checkbox" />

	ADD OBJECT 'cntCheckBoxes.chklShowInherited' AS checkbox WITH ;
		Alignment = 0, ;
		AutoSize = .T., ;
		Caption = "Inherited", ;
		ControlSource = "This.Parent.Parent.lShowInherited", ;
		FontBold = .T., ;
		Height = 17, ;
		Left = 249, ;
		Name = "chklShowInherited", ;
		Top = 8, ;
		Width = 68
		*< END OBJECT: BaseClass="checkbox" />

	ADD OBJECT 'cntCheckBoxes.chklShowNative' AS checkbox WITH ;
		Alignment = 0, ;
		AutoSize = .T., ;
		Caption = "Native", ;
		ControlSource = "This.Parent.Parent.lShowNative", ;
		FontBold = .T., ;
		Height = 17, ;
		Left = 179, ;
		Name = "chklShowNative", ;
		Top = 8, ;
		Width = 53
		*< END OBJECT: BaseClass="checkbox" />

	ADD OBJECT 'cntCheckBoxes.chklShowNonDefault' AS checkbox WITH ;
		Alignment = 0, ;
		AutoSize = .T., ;
		Caption = "Non-Default only", ;
		ControlSource = "This.Parent.Parent.lShowNonDefault", ;
		FontBold = .T., ;
		Height = 17, ;
		Left = 414, ;
		Name = "chklShowNonDefault", ;
		Top = 8, ;
		Width = 110
		*< END OBJECT: BaseClass="checkbox" />

	ADD OBJECT 'cntCheckBoxes.lblFilter' AS label WITH ;
		Alignment = 2, ;
		AutoSize = .T., ;
		Caption = "Filter:", ;
		FontBold = .T., ;
		FontSize = 9, ;
		Height = 17, ;
		Left = 8, ;
		Name = "lblFilter", ;
		Top = 9, ;
		Width = 33
		*< END OBJECT: BaseClass="label" />

	ADD OBJECT 'cntCheckBoxes.txtFilter' AS textbox WITH ;
		ControlSource = "This.Parent.Parent.cFilter", ;
		DisabledForeColor = 0,0,0, ;
		Enabled = .T., ;
		Format = "!", ;
		Height = 23, ;
		Left = 46, ;
		Name = "txtFilter", ;
		NullDisplay = "", ;
		Top = 5, ;
		Width = 109
		*< END OBJECT: BaseClass="textbox" />

	ADD OBJECT 'Label1' AS label WITH ;
		Alignment = 2, ;
		Anchor = 12, ;
		AutoSize = .F., ;
		Caption = "Ver X.X.X", ;
		FontSize = 9, ;
		Height = 16, ;
		Left = 504, ;
		Name = "Label1", ;
		Top = 603, ;
		Width = 110
		*< END OBJECT: BaseClass="label" />

	ADD OBJECT 'oleTree' AS olecontrol WITH ;
		Anchor = 135, ;
		Height = 584, ;
		Left = 8, ;
		Name = "oleTree", ;
		Top = 8, ;
		Width = 199
		*< END OBJECT: BaseClass="olecontrol" OLEObject="c:\windows\syswow64\mscomctl.ocx" Value="0M8R4KGxGuEAAAAAAAAAAAAAAAAAAAAAPgADAP7/CQAGAAAAAAAAAAAAAAABAAAAAQAAAAAAAAAAEAAAAgAAAAEAAAD+////AAAAAAAAAAD////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////9/////v////7///8EAAAA/v///////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////1IAbwBvAHQAIABFAG4AdAByAHkAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAWAAUA//////////8BAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADDGrMxVMNsBAwAAAIACAAAAAAAAAwBPAGwAZQBPAGIAagBlAGMAdABEAGEAdABhAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAB4AAgEDAAAAAgAAAP////8AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAagAAAAAAAAADAEEAYwBjAGUAcwBzAE8AYgBqAFMAaQB0AGUARABhAHQAYQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAJgACAP///////////////wAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAABcAAAAAAAAAAMAQwBoAGEAbgBnAGUAZABQAHIAbwBwAHMAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAcAAIA////////////////AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAwAAAFcBAAAAAAAABAAAAAIAAAD+////BQAAAP7///8GAAAABwAAAAgAAAAJAAAA/v////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////+2kEHHiYXREbFqAMDwKDYoIUM0EggAAACRFAAAXDwAALE8wWoBAAYAIgAAAHkATQDcAQAASgBvAAEAAAAB782rXAAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAACQAAAA4AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA5MzY4MjY1RS04NUZFLTExZDEtOEJFMy0wMDAwRjg3NTREQTF5AHMAdABlAG0AMwAyAFwAaQBuAGUAdABzAHIAdgBcAGMAbgABAACADgAAAEhpZGVTZWxlY3Rpb24ABQAAAEwAAAAADAAAAEluZGVudGF0aW9uABEAAABODQAAAAcAAAAAAAAAAAAFAMhrEAMCAGUAAAAAAAUAAIBE6RkAAQAAAFwAH97svQEABQCM6RkARgBCADYANgA3ADgAQgB9ACAAQwA6AAAAMkAKAAAATGFiZWxFZGl0AAkAAABJCgAAAAEAAAAKAAAATGluZVN0eWxlAAkAAABJCgAAAAEAAAANAAAATW91c2VQb2ludGVyAAkAAABJCgAAAAAAAAAOAAAAUGF0aFNlcGFyYXRvcgAKAAAASAAAAAABAAAAXAYAAABTdHlsZQAJAAAASQoAAAAGAAAADAAAAE9MRURyYWdNb2RlAAkAAABJCgAAAAAAAAAMAAAAT0xFRHJvcE1vZGUACQAAAEkKAAAAAAAAAAsAAABBcHBlYXJhbmNlAAkAAABJCgAAAAAAAAAOAAAARnVsbFJvd1NlbGVjdAAFAAAATAEAAAAKAAAAU2luZ2xlU2VsAAUAAABMAAAAAH//f/9//38AAAAAAAAYIB4AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAkAkQEPAFdIQVRTVEhJU0hFTFBJRABwBRYAcAUWAC4AVgGVAQgAwCFYJ/whHgBIIh4AcCxYJwAAAAABAAAAAABzACg0WCcYNFgn+DNYJ7gjHgAYIB4AAAAAAG4AcwAAAGUAYwB0AG8AcgAuAHMAAAAAADYAAADQ2x0AlNwdAFAWXCdAFlwnAAAAAADAWEQAAABAaQBvAAAAcwBcAGMAbwBsAGwAZQAAAHQAaQBvAG4AaQBuAHMAwCFYJ4wiHgDYIh4AcCxYJwEAAAAeAAAAAAAAACg0WCcYNFgn+DNYJwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADQ2x0AAAAAAFgYXCdIGFwnAAAAAAAAAAAAAAAAAAAAAP////8AAAAAAAAAAAAAAADAIVgnDCMeAEgjHgBwLFgnAQAAAB8AAAAAAAAAQCJYJyAiWCcAAAAAAAAAAAAAAAAAAAAAAAAAAEgiHgAAAAAA" />

	ADD OBJECT 'oPropGrid' AS grid WITH ;
		Anchor = 45, ;
		FontSize = 8, ;
		GridLineColor = 192,192,192, ;
		Height = 556, ;
		Left = 212, ;
		Name = "oPropGrid", ;
		ReadOnly = .T., ;
		RecordMark = .F., ;
		RecordSource = (""), ;
		RowHeight = 17, ;
		Top = 38, ;
		Width = 407
		*< END OBJECT: BaseClass="grid" />

	ADD OBJECT 'txtFullPath' AS textbox WITH ;
		Alignment = 2, ;
		Anchor = 14, ;
		BorderStyle = 0, ;
		DisabledForeColor = 0,0,0, ;
		Enabled = .F., ;
		Height = 23, ;
		Left = 340, ;
		Name = "txtFullPath", ;
		NullDisplay = "", ;
		Top = 601, ;
		Width = 196
		*< END OBJECT: BaseClass="textbox" />
	
	PROCEDURE about
		Text
		
		
		This tool was originally released by Mike Feltman at Southwest Fox 2008 under the name "Collection Explorer".
		
		See this blog post for a writeup about this tool, and other similar tools that do object display UI:
			http://mattslay.com/object-inspectors-and-explorers-for-foxpro/																								
		
		This tool was updated by Matt Slay in November 2017, and renamed as "Object Explorer". I renamed it
		because it handles more then just Collections, it also does a great job at displaying Object properties as well
		and, after all, Collections are Objects too.
		
		It also handles nested objects.
		
		*-------------------------------------------------------------------------------------------------------------
		Change log 
		
		2017-11-17	Ver 2.0.0 
					Renamed to "Object Explorer" 
					Removed OLE Control which was used to display property names and values, and replaced 
					it with a grid. This allows values (as text) to be selected from the grid, whereas the OLE 
					control did not allow cell selection for some reason. 
					
		
		2017-11-18  Ver 2.1.0 
					Added Double-Click feature to the properties grid so that if the Value field of the current row
					(i.e. the property value) is the name of a cursor that is open in the current data session
					then it will do a Browse on the cursor to show all the rows in that cursor 
		
					Added new form property "lSortTreeViewNodes" to control if nodes in treeview control will be sorted
					into alphabetcal order. If not, the nodes in the treeview appear in the natural order in which
					the child objects were originally created on the parent object. Default is .t.			
					
					
		2017-11-20  Ver 2.2.0 / JRN
					Tinkered with #include file FoxPro.h (not in my path, so may still need correction to work for others).
					
					Modified this method to use Text/EndText to simplify additions (no semi-colons).
					
					Changed the display for properties whose values cannot be determined, in FillGridWithProperties()
					
					Wrapped code in LoadProperties() to not error out when access method for a property fails.
					
					Added Property nFontsize to form.  If non-zero, used for both the grid and treeview.
					
					Changed references to Fontsize for headers to use nFontsize.
					
					Removed display of ActiveForm, Controls, and Objects, which showed redundant entries.
					
					Changed display of names in TreeView to use the "Name" property if it exists (mixed case)..
					
					Replaced collection oFlatCollection with array aObjectList due to hanging references which
						could wreak havoc in calling environment.
						
					Added Property nTreeViewWidth (used if non-zero)
					
					Added Property cCursonName, used for the name of the cursor used by the grid.  If empty,
						an obscure alternative is used.
						
					Added method "BrowseNoWait" to allow call to alternative to Browse (on double click of grid).
					
					The list of controls/objects in the treeview is alphabetical, except that objects precede child controls.
					
					A checkbox has been added to filter the list of properties displayed.  The list
						is in property cSelectedProperties.
						
					Renamed some of the methods (hopefully adding clarity)
					
																		
																															
			
		Endtext
	ENDPROC

	PROCEDURE addtoobjectlist
		Lparameters toObject
		
		Local lnRow, lnRowCount
		If Alen(This.aObjectList) > 1
			lnRowCount = Alen(This.aObjectList, 1)
			For lnRow = 1 To m.lnRowCount
				If Compobj(m.toObject, This.aObjectList[m.lnRow, 2])
					Return This.aObjectList[m.lnRow, 1]
				Endif
			Endfor
		Else
			lnRowCount = 0
		Endif
		
		lnRow = m.lnRowCount + 1
		Dimension This.aObjectList[m.lnRow, 2]
		This.aObjectList[m.lnRow, 1] = Sys(2015)
		This.aObjectList[m.lnRow, 2] = m.toObject
		
		Return This.aObjectList[m.lnRow, 1]
		
		
		
		
		
	ENDPROC

	PROCEDURE assignpublicvariable
		Lparameters toItem
		
		#Define ccTool 'Object Explorer'
		#Define ccKey  'Public Variable Name'
		
		Local lcPublicVariable, lcVariable, loException, lxNewValue
		
		lcPublicVariable = Nvl(Execscript(_Screen.cThorDispatcher, 'Get Option=', ccKey, ccTool), '')
		
		lxNewValue = This.Inputbox('Variable Name', m.lcPublicVariable, 'Public variable to be created for this node')
		If Vartype(m.lxNewValue) # 'C'
			Return
		Endif
		
		lcVariable = Alltrim(Evl(Nvl(m.lxNewValue, ''), ''))
		
		Execscript(_Screen.cThorDispatcher, 'Set Option=', ccKey, ccTool, m.lcVariable)
		If Empty(m.lcVariable)
			Return
		Endif
		
		Try
			Release m.&lcVariable
			Public &lcVariable
			&lcVariable = m.toItem
		Catch To m.loException
			Messagebox('Unable to create ' + m.lcVariable, 16)
		Endtry
		
		If Upper(m.lcPublicVariable) == Upper(m.lcVariable)
			Return
		Endif
		
		Thisform.cPublicVariable = Thisform.cPublicVariable + ' ' + m.lcVariable
	ENDPROC

	PROCEDURE browse		&& Called to Browse the table identified in the current node; see also BrowseRefresh.
		Local lcAlias, lnDataSession
		lcAlias		  = This.GetBrowseCursorName()
		lnDataSession = This.nBrowseDataSessionID
		This.BrowseCursor(m.lnDataSession, m.lcAlias)
		
	ENDPROC

	PROCEDURE browsecursor
		Lparameters lnDataSession, lcAlias
		
		Local loFormBox As 'Browse' Of 'explorer.vcx'
		
		*** DH 2022-03-03: use This.ClassLibrary rather than hard-coded Explorer.vcx so pathing not an issue
		loFormBox = newobject('frmBrowse', This.ClassLibrary)
		
		With m.loFormBox
			.nDataSession	 = m.lnDataSession
			.cAlias			 = m.lcAlias
			.lBrowseReadOnly = This.lBrowseReadOnly
			.cBrowseFont	 = This.cBrowseFont
		Endwith
		
		m.loFormBox.Show()
		
		Thisform.Show()
		
	ENDPROC

	PROCEDURE cfavorites_access
		Return This.cDefaultFavorites + ', ' + This.cMyFavorites
		
	ENDPROC

	PROCEDURE closetable
		Lparameters lcAlias
		
		Do Case
			Case Empty(m.lcAlias)
		
			Case Not Used(m.lcAlias)
		
			Otherwise
				Use In (m.lcAlias)
		
		Endcase
	ENDPROC

	PROCEDURE createcursorforgrid
		This.cCursorName = 'Explorer_PropertyValues' + Sys(2015)
		Create Cursor (This.cCursorName) (Name C(60), Type C(3), Value C(250), Favorite L)
		Index On Iif(Favorite, 'A', 'B') + Upper(Name) Tag Favorites 
		
		
		
		
	ENDPROC

	PROCEDURE createtagobject
		Local loTag As 'Empty'
		
		loTag = Createobject('Empty')
		
		AddProperty(m.loTag, 'ObjectID')
		AddProperty(m.loTag, 'Path', 		'')
		AddProperty(m.loTag, 'IsScalar', 	.F.)
		AddProperty(m.loTag, 'Value', 		Null)
		
		Return m.loTag
	ENDPROC

	PROCEDURE dblclickcursor
		Local lcCursor, lcFullObjectPath, lcPropName, lcPropVal, lcType, llOK, loException, loObject
		Local lxNewValue, lxValue
		
		If This.lDblClickReadOnly
			Return
		Endif
		
		This.EditValue()
		
	ENDPROC

	PROCEDURE Destroy
		Local lnI
		
		This.CloseTable(This.cCursorName)
		This.CloseTable(This.cCKLKeywordCursor)
		This.CloseTable(This.cVFPKeywordCursor)
		
		This.oFirstObject = Null
		
		For lnI = 1 To Alen(This.aObjectList)
			This.aObjectList[m.lnI] = Null
		Endfor
		
		
	ENDPROC

	PROCEDURE editvalue
		*-- If the Value field of the current row in the Properties cursor
		*-- is the name of a Cursor that is open in the current data session,
		*-- then Browse the cursor
		
		Local lcCursor, lcFullObjectPath, lcPropName, lcPropVal, lcType, llOK, loException, loObject
		Local lxNewValue, lxValue
		
		lcCursor = This.oPropGrid.RecordSource
		loObject = This.GetObjectReference(This.oCurrentNode)
		
		Try
			lcPropName = Trim(&lcCursor..Name)
			lcType	   = Trim(&lcCursor..Type)
			lxValue	   = m.loObject.&lcPropName
			llOK	   = .T.
		Catch
		
		Endtry
		
		Do Case
			Case m.lcType = 'A'
				This.FillGridWithArray(m.loObject, Left(m.lcPropName, At('[', m.lcPropName) - 1))
				Return
			Case '[' $ m.lcPropName
				lxValue = m.loObject.&lcPropName
			Case Not m.llOK
				Return
			Case Not m.lcType $ 'LCNDT'
				Return
		Endcase
		
		* Prompt
		
		If m.lcType = 'L'
			lxNewValue = Not m.lxValue
		Else
			lxNewValue = This.Inputbox(m.lcPropName, m.lxValue)
			Do Case
				Case Vartype(m.lxNewValue) = 'O'
					Return
				Case m.lcType = 'C'
					lxNewValue = Trim(m.lxNewValue)
			Endcase
		Endif
		
		Try
			loObject.&lcPropName = m.lxNewValue
			llOK				 = .T.
		Catch To m.loException
			Messagebox(m.loException.Message)
			llOK = .F.
		Endtry
		
		* and update the grid
		If m.llOK
		
			*** JRN 2022-02-09 : Hook to allow log of changes made
			lcFullObjectPath = This.txtFullPath.Value
			This.LogChange(Thisform.cFormName, This.oFirstObject, m.lcFullObjectPath, m.lcPropName, m.lxValue, m.lxNewValue)
		
			lcType = Vartype(m.lxNewValue)
			If m.lcType = 'C'
				lcPropVal = This.TransformCharacter(m.lxNewValue)
			Else
				lcPropVal = Transform(m.lxNewValue)
			Endif
			Replace Type With m.lcType, Value With m.lcPropVal In m.lcCursor
		
			If m.lcType = 'L'
				This.Refresh()
			Endif
		Endif
		
	ENDPROC

	PROCEDURE explore
		Lparameters toObject, tcObjectName
		*** DH 2022-04-03: added laMembers
		Local laMembers[1], loFirstNode
		
		This.LockTreeView(.T.)
		
		If Vartype(m.toObject) = 'O'
		*** DH 2022-04-03: ensure object has members
			if amembers(laMembers, m.toObject) = 0
				messagebox('Object Explorer cannot be used with this type of object.', ;
					16, 'Object Explorer')
				return .F.
			endif amembers(laMembers, m.toObject) = 0
		*** DH 2022-04-03: end of new code
			loFirstNode			 = This.LoadObject(m.toObject)
			loFirstNode.Selected = .T.
		Else
			Messagebox('You must pass an object to start using this form.')
			Return .F.
		Endif
		
		Try
			This.oleTree.NodeClick(m.loFirstNode)
		
			If Not Empty(m.tcObjectName)
				This.oleTree.Nodes(1).Text = m.tcObjectName
			Endif
		
			This.oleTree.Expand(m.loFirstNode)
		Catch
		Endtry
		
		If This.nFontSize # 0
			This.oPropGrid.FontSize	= This.nFontSize
			This.oleTree.Font.Size	= This.nFontSize
		Endif
		
		This.LockTreeView(.F.)
		
	ENDPROC

	PROCEDURE fillgridwitharray
		Lparameters toObject, tcPropName
		
		Local lcCursorName, lcPropName, lcPropType, lcPropVal, lnColumns, lnI, lnJ, lnRows, lxValue
		
		lcCursorName = This.ZapCursor(.T.)
		
		lnRows	  = Alen(m.toObject.&tcPropName, 1)
		lnColumns = Alen(m.toObject.&tcPropName, 2)
		
		For lnI = 1 To m.lnRows
			For lnJ = 1 To Max(m.lnColumns, 1)
		
				lxValue	   = m.toObject.&tcPropName.[lnI, lnJ]
				lcPropVal  = Transform(m.lxValue)
				lcPropType = Vartype(m.lxValue)
				Do Case
					Case Isnull(m.lxValue)
						lcPropVal = 'Null'
					Case m.lcPropType = 'C'
						lcPropVal = This.TransformCharacter(m.lxValue)
				Endcase
		
				lcPropName = m.tcPropName + '[' + Transform(m.lnI) + Iif(m.lnColumns > 0, ', ' + Transform(m.lnJ), '') + ']'
		
				Insert Into (m.lcCursorName) (Name, Type, Value) Values (m.lcPropName, m.lcPropType, m.lcPropVal)
			Next m.lnJ
		
			If m.lnColumns > 1	
				Append Blank
			EndIf 
		Next m.lnI
		
		This.RefreshGrid()
		
		This.cmdBrowse.Refresh()
		
		This.oPropGrid.ActivateCell(1,1)
		
		Keyboard '{UPARROW}'
		
		
		
	ENDPROC

	PROCEDURE fillgridwithproperties		&& Displays the properties for the passed node.
		Lparameters toNode
		
		Local laPEMs[1], lcCursorName, lcPropName, lcPropRef, lcPropType, lcPropVal, llArray, lnCols, lnI
		Local lnRows, loItem, lxValue
		
		lcCursorName = This.ZapCursor()
		
		If m.toNode.Tag.IsScalar
		
			Insert Into (m.lcCursorName)		;
				(Type, Value)					;
				Values							;
				(Vartype(m.toNode.Tag.Value), m.toNode.Tag.Value)
		Else
		
			loItem = This.GetObjectReference(m.toNode)
		
			If Not Isnull(m.loItem)
				For lnI = 1 To Amembers(laPEMs, m.loItem)
					lcPropName = This.FixCaseofProperty(m.laPEMs[m.lnI])
					lcPropRef  = 'loItem.' + m.laPEMs[m.lnI]
		
					If This.SkipPropertyName(m.loItem, m.lcPropName)
						Loop
					Endif
		
					Try
						lxValue	   = Evaluate(m.lcPropRef)
						lcPropVal  = Transform(m.lxValue)
						lcPropType = Type(m.lcPropRef)
						Do Case
							Case Isnull(m.lxValue)
								lcPropVal = 'Null'
							Case m.lcPropType = 'C'
								lcPropVal = This.TransformCharacter(m.lxValue)
						Endcase
					Catch
						* This occurs when a property that would normally reference an object,
						* such as parent, does not return an object reference.
						*** JRN 2017-11-19
						*	or when the property value has an access method that fails
						*	and change the display of such values
						lcPropVal  = '*** Error getting value ***'
						lcPropType = '?'
					Endtry
		
					*** JRN 2017-11-22 : array?
					Try
						llArray = Type(m.lcPropRef, 1) = [A]
					Catch
						llArray = .F.
					Endtry
		
					If m.llArray
						lnRows	   = Alen(&lcPropRef, 1)
						lnCols	   = Alen(&lcPropRef, 2)
						lcPropName = m.lcPropName + '[' + Transform(m.lnRows) + Iif(m.lnCols > 0, ', ' + Transform(m.lnCols), '') + ']'
						lcPropType = 'A'
						lcPropVal  = '<Array>'
					Endif
		
					Insert Into (m.lcCursorName) (Name, Type, Value) Values (m.lcPropName, m.lcPropType, m.lcPropVal)
				Next
			Endif
		
			Update  GridCursor Set Favorite = .T.										;
				From (This.cCursorName)    As  GridCursor								;
					Join SettingsFile													;
						On Upper(GridCursor.Name) = Upper(SettingsFile.Property)		;
						And SettingsFile.Type = 1										;
				Where SettingsFile.BitValue = .T.
		
			Select (This.cCursorName)
			If This.lSortFavorites
				Set Order To Favorites
			Else
				Set Order To
			Endif
		
			This.txtFullPath.Value = Chrtran(m.toNode.Tag.Path, ' ', '')
		
			This.SetFavoriteHighlighting()
		
		Endif && tonode.Tag.IsScalar
		
		This.RefreshGrid()
		
		This.cmdBrowse.Refresh()
		
		
		
	ENDPROC

	PROCEDURE fixcaseofproperty
		Lparameters lcName
		Local lcCKL, lcKeyWord, lcResult, lcVFP
		If Not Isnull(This.oFixCase)
			lcResult = This.oFixCase.FixCase(m.lcName, .T.)
			If Not Empty(m.lcResult)
				Return m.lcResult
			Endif
		Endif
		
		lcKeyWord = Upper(Trim(m.lcName)) + ' '
		lcCKL	  = This.cCKLKeywordCursor
		lcVFP	  = This.cVFPKeywordCursor
		Do Case
			Case (not Empty(m.lcCKL)) and Used(m.lcCKL) And Seek(m.lcKeyWord, m.lcCKL, 'Keyword')
				Return Trim(&lcCKL..KeyWord)
			Case (not Empty(m.lcVFP)) and Used(m.lcVFP) And Seek(m.lcKeyWord, m.lcVFP, 'Token')
				Return Trim(&lcVFP..Token)
			Case m.lcName # Upper(m.lcName)
				Return m.lcName
			Otherwise
				Return Lower(m.lcName)
		Endcase
		
	ENDPROC

	PROCEDURE getbrowsecursorname		&& Returns the name of the cursor for the Browse button and saves the DataSessionID it is found in.
		Local lcAlias, lnDataSession, loCurrentObject, loTopObject
		
		loTopObject		= This.oFirstObject
		loCurrentObject	= This.GetObjectReference(This.oCurrentNode)
		
		lcAlias		  = ''
		lnDataSession = 0
		Do Case
				*** DH 2022-03-04: handle no object
				* object not found or released
			Case Isnull(m.loCurrentObject)
				Messagebox('The selected object no longer exists. Object Explorer will close.',			;
					  0 + 16, Thisform.Caption)
				Thisform.Release()
				*** DH 2022-03-04: end of new code
				
				*** JRN 2023-07-25 : Scalar
			Case Vartype(m.loCurrentObject) # 'O'
		
				* current node has own data session and cAlias
			Case Pemstatus(m.loCurrentObject, 'DataSessionID', 5)
				If Pemstatus(m.loCurrentObject, 'cAlias', 5)
					lcAlias		  =  m.loCurrentObject.cAlias
					lnDataSession = m.loCurrentObject.DataSessionId
				Endif
		
				* top node does not its own data session
			Case Pemstatus(m.loTopObject, 'DataSessionID', 5) = .F.
		
				* current node has cAlias in data session for top object
			Case Pemstatus(m.loCurrentObject, 'cAlias', 5)
				lcAlias		  =  m.loCurrentObject.cAlias
				lnDataSession = m.loTopObject.DataSessionId
		
				* current node has RecordSource in data session for top object
			Case Pemstatus(m.loCurrentObject, 'RecordSource', 5)
				lcAlias		  =  m.loCurrentObject.RecordSource
				lnDataSession = m.loTopObject.DataSessionId
		
				* current node is a column in a grid and has RecordSource in data session for top object
			Case Pemstatus(m.loCurrentObject, 'BaseClass', 5) And Not Pemstatus(m.loCurrentObject, 'BaseClass', 2) And Upper(m.loCurrentObject.BaseClass) = 'COLUMN'
				lcAlias		  =  m.loCurrentObject.Parent.RecordSource
				lnDataSession = m.loTopObject.DataSessionId
		
				* top node has cAlias in data session for top object
			Case Pemstatus(m.loTopObject, 'cAlias', 5)
				lcAlias		  =  m.loTopObject.cAlias
				lnDataSession = m.loTopObject.DataSessionId
		Endcase
		
		This.nBrowseDataSessionID = m.lnDataSession
		Return m.lcAlias
	ENDPROC

	PROCEDURE getcollectionnodename		&& For items in a collection, returns the caption to be used for nodes in the TreeView
		Lparameters toCollection, toItem, tcKey, tnIndex
		
		Local lcDefault
		
		lcDefault = This.cCollectionItemPrefix + '[' + Transform(m.tnIndex) + ']'
		Return Evl(m.tcKey, m.lcDefault)
		
		
	ENDPROC

	PROCEDURE getnodefor
		Lparameters toObject
		
		Local loNode, loThisObject
		
		For Each m.loNode In This.oleTree.Nodes FoxObject
			loThisObject = This.GetObjectReference(m.loNode)
			If Vartype(m.loThisObject) = 'O' and Compobj(m.loThisObject, m.toObject)
				Return m.loNode
			Endif
		Endfor
		
		Return Null
		
		
	ENDPROC

	PROCEDURE getnodetext		&& For objects other than collections, returns the caption to be used for nodes in the TreeView
		Lparameters loObject, lcNodeText
		
		Local lcCaption, lcControlSource, lcExtraText, lnAT, lnI, loChild
		
		lcExtraText = ''
		
		If Pemstatus(m.loObject, 'BaseClass', 5) And Not Pemstatus(m.loObject, 'BaseClass', 2) And m.loObject.BaseClass = 'Column'
			For lnI = 1 To m.loObject.ControlCount
				loChild = m.loObject.Controls[m.lnI]
				If Pemstatus(m.loChild, 'BaseClass', 5) And Not Pemstatus(m.loChild, 'BaseClass', 2) And m.loChild.BaseClass = 'Header'
					lcCaption = AllTrim(Strtran(m.loChild.Caption, Chr[13], ' '))
					If Not Empty(m.lcCaption)
						If Pemstatus(m.loObject, 'h_SuperHdgsText', 5) And Not Empty (m.loObject.h_SuperHdgsText[1])
							lcCaption = m.loObject.h_SuperHdgsText[1] + ' ... ' + m.lcCaption
						Endif
						lcExtraText = '"' + m.lcCaption + '"'
					Endif
				Endif
			Endfor
		
		Else
			Do Case
				Case Pemstatus(m.loObject, 'Caption', 5) And Not Empty(m.loObject.Caption)
					lcExtraText = '"' + m.loObject.Caption + '"'
				Case Pemstatus(m.loObject, 'cCaption', 5) And Not Empty(m.loObject.cCaption)
					lcExtraText = '"' + m.loObject.cCaption + '"'
			Endcase
		
			Do Case
				Case Pemstatus(m.loObject, 'ControlSource', 5) And Not Empty(m.loObject.ControlSource)
					lcControlSource	= m.loObject.ControlSource
					lnAT			= Atc('.odata.', m.lcControlSource)
					If m.lnAT # 0
						lcControlSource = Substr(m.lcControlSource, m.lnAT)
					Endif
					lcExtraText = m.lcExtraText + Iif(Empty(m.lcExtraText), '', ' - ') + m.lcControlSource
				Case Pemstatus(m.loObject, 'cControlSource', 5) And Not Empty(m.loObject.cControlSource)
					lcControlSource	= m.loObject.cControlSource
					lnAT			= Atc('.odata.', m.lcControlSource)
					If m.lnAT # 0
						lcControlSource = Substr(m.lcControlSource, m.lnAT)
					Endif
					lcExtraText = m.lcExtraText + Iif(Empty(m.lcExtraText), '', ' - ') + m.lcControlSource
			Endcase
		
			If Pemstatus(m.loObject, 'RecordSource', 5) And Not Empty(m.loObject.RecordSource)
				lcExtraText = m.loObject.RecordSource
			Endif
		
			If Pemstatus(m.loObject, 'cAlias', 5) And Not Empty(m.loObject.cAlias)
				lcExtraText = m.loObject.cAlias
			Endif
		Endif
		
		If Empty(m.lcExtraText)
			Return m.lcNodeText
		Else
			Return m.lcNodeText + ' (' + Alltrim(m.lcExtraText) + ')'
		Endif
		
		
	ENDPROC

	PROCEDURE getobjectreference		&& Returns the object reference to the item represented by a node.
		Lparameters	toNode
		
		Local lnRow
		
		If Vartype(m.toNode.Tag) = 'O'
			lnRow = Ascan(This.aObjectList, m.toNode.Tag.ObjectID, 1, -1, 1, 15)
			If m.lnRow # 0
				Return This.aObjectList[m.lnRow, 2]
			Endif
		Else
			Return Null
		Endif
		
		
	ENDPROC

	PROCEDURE getsavedproperty
		Lparameters lcProperty
		= Seek(Upper(m.lcProperty))
		Return Value
		
	ENDPROC

	PROCEDURE gridrightclick
		Local lcCursor, loThis
		
		Define Popup MyPopup ShortCut Relative From Mrow(), Mcol()
		
		loThis = This
		Define Bar 1 Of MyPopup Prompt '\<Edit Value' Key Alt+F12, 'Dbl-Click'
		Define Bar 2 Of MyPopup Prompt '\<Favorite'
		
		On Selection Bar 1 Of MyPopup m.loThis.EditValue()
		On Selection Bar 2 Of MyPopup m.loThis.ToggleFavorite()
		
		lcCursor   = This.cCursorName
		If &lcCursor..Favorite
			Set Mark of Bar 2 Of MyPopup To .T.
		Endif
		
		Activate Popup MyPopup
		
	ENDPROC

	PROCEDURE haschildobjects
		Lparameters toObject
		
		Local llFound, lnI, loException, lvProperty
		If This.lShowItems And Type([toObject.Count]) = [N] And m.toObject.Count > 0
			Return .T.
		Endif
		
		If This.lShowMemberobjects And Amembers(laMembers, m.toObject, 2) > 0
			Return .T.
		Endif
		
		For lnI = 1 To Amembers(laMembers, m.toObject)
		
			If This.SkipPropertyName(m.toObject, m.laMembers[m.lnI])
				Loop
			Endif
		
			Try
				lvProperty = Evaluate([toObject.] + m.laMembers[m.lnI])
			Catch To m.loException
				lvProperty = Null
			Endtry
		
			Try
				Do Case
					Case Type([toObject.] + m.laMembers[m.lnI], 1) = [A]
						*	Array
					Case Type([lvProperty]) = [O] And Not Isnull(m.lvProperty)
						llFound = .T.
					Case Type([toObject.] + m.laMembers[m.lnI], 1) = [C]
						llFound = .T.
				Endcase
			Catch To m.loException
		
			Endtry
		
			If m.llFound
				Return .T.
			Endif
		
		Next
		
		
		Return .F.
		
	ENDPROC

	PROCEDURE Init
		Local laFavorites[1], lnCount, lnI
		
		*!* ******** JRN Removed 2022-11-23 ********
		*!* lnCount = Alines(laFavorites, Upper(This.cFavorites), 1, ' ', ',', Chr[13], chr[10], Chr[9])
		*!* Create Cursor Favorites (Name C(60))
		*!* For lnI = 1 To m.lnCount
		*!* 	Insert Into Favorites Values(m.laFavorites[m.lnI])
		*!* Endfor
		*!* Index On Name Tag Name
		
		This.CreateCursorForGrid()
		Select (This.cCursorName)
		
		This.SetupGridColumns()
		
		If Pemstatus(_Screen, 'cThorDispatcher', 5)
			Execscript (_Screen.cThorDispatcher, 'Thor_Proc_GetISXOptions')
			try
				This.oFixCase = _Screen.oISXOptions.oKeyWordList
			catch
			endtry
		Else
			This.cCKLKeywordCursor = This.UseKeywordTable(This.cCKLKeywordTableName, 'CKL')
			This.cVFPKeywordCursor = This.UseKeywordTable(This.cVFPKeywordTableName, 'VFP')
		Endif
		
		
		
		
	ENDPROC

	PROCEDURE inputbox
		Lparameters lcPropName, lxValue, lcCaption
		
		Local lxResult As 'Empty'
		Local lnCol, lnRow, loInputBox
		
		*** DH 2022-02-27: use InputBox_ShowWindow1 in we're in a top-level form rather than if we're modal
		***loInputBox		= Newobject(Iif(Thisform.WindowType = 0, 'InputBox', 'InputBox_ShowWindow1'), 'explorer.vcx')
		*** DH 2022-03-03: use This.ClassLibrary rather than hard-coded Explorer.vcx so pathing not an issue
		loInputBox = newobject(iif(Thisform.ShowWindow = 0, 'InputBox', 'InputBox_ShowWindow1'), This.ClassLibrary)
		
		If This.lAlignInputBoxToCursor
			lnRow = Mrow(0, 3)
			lnCol = Mcol(0, 3)
		
			loInputBox.Top	= Thisform.Top + m.lnRow + 45
			loInputBox.Left	= Thisform.Left + m.lnCol - 110
		
		Else
			loInputBox.Top	= Thisform.Top + (Thisform.Height - m.loInputBox.Height) / 3
			loInputBox.Left	= (_vfp.Width - m.loInputBox.Width) / 2
		Endif
		
		loInputBox.Caption	= Evl(m.lcCaption, 'Enter value for ' + m.lcPropName) && or =(phrase to execute)'
		loInputBox.cCaption	= m.lcPropName
		loInputBox.xValue	= m.lxValue
		
		m.loInputBox.Show()
		
		lxResult = Createobject('Empty')
		If Vartype(m.loInputBox) = 'O'
			If m.loInputBox.lCancelled = .F.
				lxResult = m.loInputBox.xValue
			Endif
			m.loInputBox.Release()
		Endif
		
		Return m.lxResult
		
		
		
		
	ENDPROC

	PROCEDURE loadchildobjects		&& Loads the member objects of an object into the tree view.
		Lparameters toObject, toParentNode
		
		Local laMembers[1], lnI, loObject
		
		If This.lShowMemberobjects And Type([toObject]) = [O]
			For lnI = 1 To Amembers(laMembers, m.toObject, 2)
				loObject = Evaluate([toObject.] + m.laMembers[m.lnI])
				This.LoadObject(m.loObject, m.toParentNode)
			Next
		Endif
		
	ENDPROC

	PROCEDURE loadcollectionitems		&& Loads the items in a collection into the treeview.
		Lparameters			;
			toObject,		;
			toParentNode
		
		Local lcName, lnI, loNode, loTag, lvItem
		
		If This.lShowItems And Type([toObject.Count]) = [N] And m.toObject.Count > 0
			Try
				For lnI = m.toObject.Count To 1 Step - 1
					lvItem = m.toObject.Item(m.lnI)
					If Type([lvItem]) = [O]
						lcName	  = This.GetCollectionNodeName(m.toObject, m.lvItem, m.toObject.GetKey(m.lnI), m.lnI)
						This.LoadObject(m.lvItem, m.toParentNode, m.lcName)
					Else
						loNode		  = This.NewNode()
						loNode.Parent = m.toParentNode
						loNode.Text	  = This.GetCollectionNodeName(, , , m.lnI)  + ' = ' + Left(Transform(m.lvItem), 25)
		
						loTag		   = This.CreateTagObject()
						loTag.IsScalar = .T.
						loTag.Value	   = m.lvItem
		
						loNode.Tag	= m.loTag
					Endif
				Next
			Catch
			Endtry
		Endif
		
		
	ENDPROC

	PROCEDURE loadobject		&& Loads an object into the TreeView.
		Lparameters toObject, toParentNode, tcName
		
		Local loTag As 'Empty'
		Local lcName, lcNodeText, loDummyNode, loException, loNode
		
		With This
			loTag = This.CreateTagObject()
		
			If Isnull(.oFirstObject)
				.oFirstObject = m.toObject
				.oleTree.Nodes.Clear()
		*** DH 2022-03-03: bind to QueryUnload so closing the form works
				if pemstatus(.oFirstObject, 'QueryUnload', 5)
					bindevent(.oFirstObject, 'QueryUnload', This, 'OnObjectReleased')
				endif pemstatus(.oFirstObject, 'QueryUnload', 5)
		*** DH 2022-03-03: end of new code
			Endif
		
			Try
				lcName = Sys(1272, m.toObject)
			Catch To m.loException
				lcName = 'Unknown'
			Endtry
		*** DH 2022-02-27: call NewNode
		***	loNode		   = .oleTree.Nodes.Add()
			loNode         = .NewNode(m.toParentNode)
			loTag.ObjectID = This.AddToObjectList(m.toObject)
			loNode.Tag	= m.loTag
		
			If Type([toParentNode.Text]) = 'C'
		*** DH 2022-02-27: don't set Parent since we added the node to the parent earlier
		*		loNode.Parent = m.toParentNode
				loTag.Path	  = m.toParentNode.Tag.Path
			Endif
		
			Do Case
				Case Not Empty(m.tcName) And Type([tcName]) = 'C'
					lcNodeText = m.tcName
				Case Pemstatus(m.toObject, [Name], 5)
					lcNodeText = m.toObject.Name
				Case Not Empty(m.lcName) And m.lcName # [unknown type]
					lcNodeText = m.lcName
				Case Pemstatus(m.toObject, [Class], 5)
					lcNodeText = m.toObject.Class
				Otherwise
					lcNodeText = [Object]
			Endcase
		
			If .oleTree.Nodes.Count > 1
				loTag.Path = m.loTag.Path + '.' + Trim(m.lcNodeText)
			EndIf 
		
			*!* ******************** Removed 05/20/2020 *****************
			*!* If Inlist(Left(m.lcNodeText, 1), 'O', 'o')
			*!* 	lcNodeText = Strtran(m.lcNodeText, 'O', 'o', 1, 1, 1)
			*!* Endif
		
			If This.HasChildObjects(m.toObject)
		*** DH 2022-02-27: call NewNode and don't set Parent
		***		loDummyNode		   = This.oleTree.Nodes.Add()
				loDummyNode		   = .NewNode(m.loNode)
				loDummyNode.Text   = [(Loading...)]
		***		loDummyNode.Parent = m.loNode
				lcNodeText		   = ' ' + m.lcNodeText
			Endif
		
			loNode.Text	= This.GetNodeText(m.toObject, m.lcNodeText)
		
			loNode.Expanded = .F.
		Endwith
		
		Return m.loNode
		
	ENDPROC

	PROCEDURE loadotherobjects		&& Loads the properties of an object into the treeview.
		Lparameters			;
			toObject,		;
			toParentNode
		
		Local laMembers[1], lcMemberName, lcName, lnI, lnJ, loCollectionNode, loException, loObject
		Local lvProperty
		
		If Type([toObject]) # [O]
			Return
		Endif
		
		
		For lnI = 1 To Amembers(laMembers, m.toObject)
		
			lcMemberName = m.laMembers[m.lnI]
			If This.SkipPropertyName(m.toObject, lcMemberName)
				Loop
			Endif
		
			Try
				lvProperty = Evaluate([toObject.] + lcMemberName)
			Catch To m.loException
				lvProperty = Null
			Endtry
		
			*** JRN 2017-11-19 : Wrap with Try/Catch, needed when an access method for a property fails.
			Try
				Do Case
					Case Type([toObject.] + lcMemberName, 1) = [A]
						*	Array
					Case Type([lvProperty]) = [O] And Not Isnull(m.lvProperty)
						lcName = lcMemberName
						If Left(m.lcName, 1) = 'O'
							lcName = 'o' + Substr(m.lcName, 2)
						EndIf
						If 0 = Atc(' ' + lcName + ' ', ' ' + Chrtran(This.cSkippedObjectNames, ',', ' ') + ' ')
							This.LoadObject(m.lvProperty, m.toParentNode, '  ' + This.FixCaseofProperty(m.lcName))
						EndIf 
					Case Type([toObject.] + lcMemberName, 1) = [C]
						*   Collection
						loCollectionNode = Null
						Try
							For lnJ = 1 To Evaluate([toObject.] + lcMemberName + [.Count])
								loObject = Evaluate([toObject.] + lcMemberName + [(] + Transform(m.lnJ) + [)])
								If Isnull(m.loCollectionNode)
		*** DH 2022-02-27: call NewNode and don't set Parent
		***							loCollectionNode		= This.oleTree.Nodes.Add()
		***							loCollectionNode.Parent	= m.toParentNode
									loCollectionNode		= This.NewNode(m.toParentNode)
									loCollectionNode.Text	= lcMemberName
								Endif
								This.LoadObject(m.loObject, m.loCollectionNode)
							Next
						Catch To m.loException
		
						Endtry
						loCollectionNode = Null
				Endcase
			Catch To m.loException
		
			Endtry
		Next
		
		 
	ENDPROC

	PROCEDURE locktreeview
		Lparameters tlLock
		Local lnStatus
		
		Declare Integer LockWindowUpdate In Win32API Integer nHandle
		
		Do Case
			Case m.tlLock And This.lWindowLocked
		
			Case m.tlLock
				lnStatus		   = LockWindowUpdate(This.oleTree.HWnd)
				This.lWindowLocked = .T.
		
			Otherwise
				LockWindowUpdate(0)
				This.lWindowLocked = .F.
		Endcase
		
		
		
		
	ENDPROC

	PROCEDURE logchange		&& Hook to allow capture of changes made to properties
		Lparameters tcFileName, toTopObject, tcFullObjectPath, tcPropName, txOldValue, txNewValue
		
		*  Called for each change to a property in the grid
		
		* Parameters:
		*	tcFileName			Full file name of the form (if available)
		*	toTopObject			Top object in the TreeView
		*	tcFullObjectPath	Relative path from <toTopObject> to the object being edited
		*	tcPropName			Name of property being edited
		*	txOldValue			Previous value of the property
		*	txNewValue			New value
		
		
	ENDPROC

	PROCEDURE navigatetoobject
		Lparameters toObject
		
		Local laObjects[1], lnCount, lnI, loNode, loObject
		
		Dimension m.laObjects[1]
		laObjects[1] = m.toObject
		lnCount		 = 1
		
		loObject = m.toObject
		Do While Compobj(m.loObject, This.oFirstObject) = .F.
			If Pemstatus(m.loObject, 'Parent', 5)
				loObject = m.loObject.Parent
				lnCount	 = m.lnCount + 1
				Dimension m.laObjects[m.lnCount]
				laObjects[m.lnCount] = m.loObject
			Else
				laObjects = Null
				Return .F.
			Endif
		Enddo
		
		For lnI = m.lnCount To 1 Step - 1
			loNode = This.GetNodeFor(m.laObjects[m.lnI])
		*** DH 2022-04-02: ensure node isn't null
			if vartype(loNode) = 'O'
				This.oleTree.Expand(m.loNode)
		*** DH 2022-02-27: ensure the node is expanded
				m.loNode.Expanded = .T.
			endif vartype(loNode) = 'O'
		Endfor
		laObjects = Null
		
		*** DH 2022-04-02: ensure node isn't null
		if vartype(loNode) = 'O'
		*** DH 2022-02-27: ensure the node is visible
			loNode.EnsureVisible()
			loNode.Selected		 = .T.
			This.FillGridWithProperties(loNode)
		endif vartype(loNode) = 'O'
		
	ENDPROC

	PROCEDURE newnode		&& Adds an empty node to the treeview.
		*** DH 2022-02-27: accept toParentNode
		lparameters toParentNode
		Local loNode
		
		*** DH 2022-02-27: pass the appropriate parameters to Add
		***loNode = This.oleTree.Nodes.Add()
		if type([toParentNode.Text]) = 'C'
			if empty(toParentNode.Key)
				toParentNode.Key = sys(2015)
			endif empty(toParentNode.Key)
			loNode = This.oleTree.Nodes.Add(toParentNode.Key, 4)
		else
			loNode = This.oleTree.Nodes.Add()
		endif type([toParentNode.Text]) = 'C'
		*** DH 2022-02-27: end of modification
		
		Return loNode
		
	ENDPROC

	PROCEDURE ocurrentnode_access
		Local loNode
		
		For Each m.loNode In This.oleTree.Nodes FoxObject
			If m.loNode.Selected
				Return m.loNode
			Endif
		Endfor
		
		Return Null
		
		
	ENDPROC

	PROCEDURE onobjectreleased		&& Fired when the object being explored is released
		*** DH 2022-03-03: added this method, which is bound to QueryUnload by
		***		LoadObject so closing the form works
		Thisform.Release()
		
	ENDPROC

	PROCEDURE pemstatusfails
		Lparameters loItem, m.lcName
		
		Local llDummy, llResult, loException
		Try
			llDummy	 = Pemstatus(m.loItem, m.lcName, 0)
			llResult = .F.
		Catch To m.loException
			llResult = .T.
		Endtry
		
		Return m.llResult
	ENDPROC

	PROCEDURE refreshgrid
		Goto Top In (This.cCursorName)
		This.oPropGrid.Column4.width = 0
		This.oPropGrid.Refresh()
		
		*!* ******************** Removed 05/18/2020 *****************
		*!* With This.oPropGrid
		*!* 	.Refresh()
		*!* 	.AutoFit()
		
		*!* 	.Column1.Width = Max(.Column1.Width + 12, 150)
		*!* 	.Column2.Width = 30
		*!* 	.Column3.Width = Max(.Column3.Width + 60, 400)
		
		*!* 	.Refresh()
		*!* Endwith
		
		
	ENDPROC

	PROCEDURE resizecontrols
	ENDPROC

	PROCEDURE saveproperty
		Lparameters lcProperty)
				= Seek(Upper(m.lcProperty))
				Replace Value With Evl(Getpem(This, m.lcProperty),0)
				
	ENDPROC

	PROCEDURE setfavoritehighlighting
		Local lcDynBackColor, lcDynamicFontBold
		
		With This.oPropGrid
			lcDynamicFontBold		 = Iif(This.lHighlightFavorites, 'Favorite', '')
			.Column1.DynamicFontBold = m.lcDynamicFontBold
			.Column2.DynamicFontBold = m.lcDynamicFontBold
			.Column3.DynamicFontBold = m.lcDynamicFontBold
		
			lcDynBackColor			  = Iif(This.lHighlightFavorites, Textmerge('IIF(Favorite, <<This.nFavoritesBackColor>>, Rgb(255, 255, 255))'), '')
			.Column1.DynamicBackColor = m.lcDynBackColor
			.Column2.DynamicBackColor = m.lcDynBackColor
			.Column3.DynamicBackColor = m.lcDynBackColor
		Endwith
		
	ENDPROC

	PROCEDURE setupgridcolumns
		Local lcDynBackColor, lnFontSize
		
		lnFontSize = Evl(This.nFontSize, 8)
		
		Select(This.cCursorName)
		
		With This.oPropGrid
			.RecordSource = ''
			.ColumnCount  = -1
			.RecordSource = This.cCursorName
		
			.RecordMark	= .F.
			.DeleteMark	= .F.
		
			.Column1.Header1.Alignment = 0
			.Column1.Header1.FontSize  = m.lnFontSize
			.Column1.Width			   = 150
			.Column1.ReadOnly		   = .T.
		
			.Column2.Header1.Alignment = 2
			.Column2.Header1.FontSize  = m.lnFontSize
			.Column2.Width			   = 30
			.Column2.Alignment		   = 2
			.Column2.ReadOnly		   = .T.
		
			.Column3.Header1.Alignment = 0
			.Column3.Header1.FontSize  = m.lnFontSize
			.Column3.Width			   = 1000
		
			.Column4.Width	 = 0
			.Column4.Visible = .F.
		
			This.SetFavoriteHighlighting()
		
			Bindevent(.Column1.Text1, 'DblClick', This, 'DblClickCursor')
			Bindevent(.Column2.Text1, 'DblClick', This, 'DblClickCursor')
			Bindevent(.Column3.Text1, 'DblClick', This, 'DblClickCursor')
		
			Bindevent(.Column1.Text1, 'RightClick', This, 'GridRightClick')
			Bindevent(.Column2.Text1, 'RightClick', This, 'GridRightClick')
			Bindevent(.Column3.Text1, 'RightClick', This, 'GridRightClick')
		
		EndWith
		
		
	ENDPROC

	PROCEDURE skippropertyname
		Lparameters loItem, lcName
		
		Do Case
				* always skip these properties
			Case Atc(' ' + m.lcName + ' ', ' ACTIVECONTROL ACTIVEFORM COLUMNS CONTROLS OBJECTS PARENT PAGES _MEMBERDATA ') # 0
				Return .T.
				
			Case This.PemstatusFails(m.loItem, m.lcName) && This occurs for OLE things
				Return .F.
		
			Case Pemstatus(m.loItem, m.lcName, 0) = .F. And This.lShowNonDefault = .T.
				Return .T.
		
			Case Pemstatus(m.loItem, 'BaseClass', 5) = .F.
				Return .F.
		
			Case Pemstatus(m.loItem, m.lcName, 4) = .F.
				Return This.lShowNative = .F.
		
			Case Pemstatus(m.loItem, m.lcName, 6) = .T.
				Return This.lShowInherited = .F.
		
			Otherwise
				Return This.lShowCustom = .F.
		
		Endcase
		
		
		
	ENDPROC

	PROCEDURE sortnode
		Lparameters toObject
		
		Do Case
			Case This.lSortTreeViewNodes = .F.
				Return .F.
			Case Type([toObject.Count]) = [N] && Collection?
				Return .F.
			Otherwise
				Return .T.
		Endcase
		
	ENDPROC

	PROCEDURE togglefavorite
		Local lcCursor, llNewValue
		
		lcCursor   = This.cCursorName
		llNewValue = Not &lcCursor..Favorite
		Replace Favorite With m.llNewValue In (m.lcCursor)
		
		Thisform.SaveProperty(Trim(&lcCursor..Name), m.llNewValue, 1)
		
		
		
	ENDPROC

	PROCEDURE transformcharacter		&& Returns the text for character values that appear in the third column of the grid.
		Lparameters lcValue
		Local MaxWidth
		
		MaxWidth = Max(40, Floor(This.nMaxCharacterWidth))
		Return '"' + Left(m.lcValue, m.MaxWidth) + '"' + Iif(Len(m.lcValue) > m.MaxWidth, ' ...', '') + '  (' + Transform(Len(m.lcValue)) + ')'
	ENDPROC

	PROCEDURE treeviewrightclick
		Lparameters toNode
		
		Local lcPublicVariable, loItem, loThis
		
		If Pemstatus(_Screen, 'cThorDispatcher', 5) = .F.
			Return
		Endif
		
		loItem = This.GetObjectReference(m.toNode)
		
		If Isnull(m.loItem)
			Return
		Endif
		
		This.AssignPublicVariable(m.loItem)
		
		*!* ******** JRN Removed 2022-12-26 ********
		*!* loThis = This
		*!* Define Popup MyPopup ShortCut Relative From Mrow(), Mcol()
		
		*!* Define Bar 1 Of MyPopup Prompt 'Assign this node to a public variable'
		*!* On Selection Bar 1 Of MyPopup m.loThis.AssignPublicVariable(m.loItem)
		
		*!* Activate Popup MyPopup
		
	ENDPROC

	PROCEDURE usekeywordtable
		Lparameters lcFileName, lcPrefix
		
		Local lcCursor
		Do Case
			Case Empty(m.lcFileName)
				Return .F.
			Case Not File(m.lcFileName)
				Return .F.
			Otherwise
				lcCursor = lcPrefix + '_Keywords' + Sys(2015)
				Use (m.lcFileName) Again Shared In 0 Alias (m.lcCursor)
				Return m.lcCursor
		Endcase
		
	ENDPROC

	PROCEDURE zapcursor
		Lparameters llNoOrder
		
		Local lcSafety
		Select (This.cCursorName)
		
		lcSafety = Set('Safety')
		Set Safety Off
		
		Zap
		
		Set Safety &lcSafety
		
		If m.llNoOrder
			Set Order To
		Else
			Set Order To Favorites
		Endif
		
		Return This.cCursorName
	ENDPROC

	PROCEDURE chklHighlightFavorites.Refresh
		This.Visible = Not Empty(This.Parent.cFavorites)
		
	ENDPROC

	PROCEDURE chklHighlightFavorites.Valid
		This.Parent.SetFavoriteHighlighting()
		This.Parent.oPropGrid.SetFocus()
		
	ENDPROC

	PROCEDURE chklSortFavorites.Refresh
		This.Visible = Not Empty(This.Parent.cFavorites)
		
	ENDPROC

	PROCEDURE chklSortFavorites.Valid
		This.Parent.FillGridWithProperties(This.Parent.oCurrentNode)
	ENDPROC

	PROCEDURE cmdBrowse.Click
		This.Parent.Browse()
		
	ENDPROC

	PROCEDURE cmdBrowse.Refresh
		Local lcBrowseAlias
		
		lcBrowseAlias = This.Parent.GetBrowseCursorName()
		
		If Empty(m.lcBrowseAlias)
			This.Caption = 'Browse'
			This.Visible = .F.
		Else
			This.Caption = 'Browse ' + m.lcBrowseAlias
			This.Visible = .T.
		Endif
		
		
		
		
	ENDPROC

	PROCEDURE cntCheckBoxes.chklShowCustom.Valid
		This.Parent.Parent.FillGridWithProperties(This.Parent.Parent.oCurrentNode)
	ENDPROC

	PROCEDURE cntCheckBoxes.chklShowInherited.Valid
		This.Parent.Parent.FillGridWithProperties(This.Parent.Parent.oCurrentNode)
	ENDPROC

	PROCEDURE cntCheckBoxes.chklShowNative.Valid
		This.Parent.Parent.FillGridWithProperties(This.Parent.Parent.oCurrentNode)
	ENDPROC

	PROCEDURE cntCheckBoxes.chklShowNonDefault.Valid
		This.Parent.Parent.FillGridWithProperties(This.Parent.Parent.oCurrentNode)
	ENDPROC

	PROCEDURE cntCheckBoxes.txtFilter.InteractiveChange
		Local lcCursorName, lcFilter
		Select (This.Parent.Parent.cCursorName)
		
		If Empty(This.Value)
			Set Filter To
		Else
			lcFilter = ['] + (Alltrim(This.Value)) + [' $ Upper(Name + Value)]
			Set Filter To &lcFilter 
		Endif
		
		Goto top 
		This.Parent.Parent.oPropGrid.Refresh()
	ENDPROC

	PROCEDURE Label1.Init
		This.Caption = VERSION_NUMBER
	ENDPROC

	PROCEDURE oleTree.Click
		*** ActiveX Control Event ***
		
	ENDPROC

	PROCEDURE oleTree.Expand
		*** ActiveX Control Event ***
		Lparameters toNode
		
		Local lnI, loObject
		
		This.Parent.LockTreeView(.T.)
		
		loObject = This.Parent.GetObjectReference(m.toNode)
		
		For lnI = 1 To m.toNode.Children
			This.Nodes.Remove(m.toNode.Child.Index)
		Next
		
		loObject = This.Parent.GetObjectReference(m.toNode)
		
		This.Parent.LoadCollectionItems(m.loObject, m.toNode)
		This.Parent.LoadChildObjects(m.loObject, m.toNode)
		This.Parent.LoadOtherObjects(m.loObject, m.toNode)
		
		
		toNode.Sorted = This.Parent.SortNode(m.loObject)
		
		This.Parent.LockTreeView(.F.)
		
		Return
		
		
		
	ENDPROC

	PROCEDURE oleTree.MouseDown
		*** ActiveX Control Event ***
		LPARAMETERS button, shift, x, y
		
		This.Parent.nMouseButton = button
		
	ENDPROC

	PROCEDURE oleTree.NodeClick
		*** ActiveX Control Event ***
		Lparameters toNode
		
		If This.Parent.nMouseButton <= 1
			This.Parent.FillGridWithProperties(m.toNode)
		Else
			This.Parent.TreeViewRightClick(m.toNode)
		Endif
		
		
		
	ENDPROC

	PROCEDURE oleTree.Refresh
		*** ActiveX Control Method ***
		
	ENDPROC

ENDDEFINE
